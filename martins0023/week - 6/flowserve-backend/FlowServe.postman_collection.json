{
	"info": {
		"_postman_id": "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d",
		"name": "FlowServe API",
		"description": "API for FlowServe, a fintech app for managing users and simulating transactions.\n\nAll routes are prefixed with `/api/v1`.\n\n### Automated Variables\nThis collection automatically saves user IDs when you create them:\n- `[POST] Create User` sets `{{aliceUserId}}`\n- `[POST] Create Another User (Bob)` sets `{{bobUserId}}`\n\nRun these requests first to populate the variables used in other requests.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Users",
			"description": "Endpoints for creating, retrieving, and managing user accounts.",
			"item": [
				{
					"name": "[POST] Create User (Alice)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Parse the response",
									"const response = pm.response.json();",
									"",
									"// Check if the request was successful and data exists",
									"if (pm.response.code === 201 && response.data && response.data.id) {",
									"    // Set the 'aliceUserId' in the collection variables",
									"    pm.collectionVariables.set(\"aliceUserId\", response.data.id);",
									"    console.log(\"Set aliceUserId to:\", response.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"alice@flowserve.com\",\n  \"name\": \"Alice Smith\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							]
						},
						"description": "Registers a new user (Alice). \n\nThe `walletBalance` is set to a default value (e.g., 1000) on the server. The password will be hashed.\n\n**This request automatically saves the new user's ID to the `{{aliceUserId}}` collection variable.**"
					},
					"response": []
				},
				{
					"name": "[POST] Create Another User (Bob)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Parse the response",
									"const response = pm.response.json();",
									"",
									"// Check if the request was successful and data exists",
									"if (pm.response.code === 201 && response.data && response.data.id) {",
									"    // Set the 'bobUserId' in the collection variables",
									"    pm.collectionVariables.set(\"bobUserId\", response.data.id);",
									"    console.log(\"Set bobUserId to:\", response.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"bob@flowserve.com\",\n  \"name\": \"Bob Johnson\",\n  \"password\": \"password456\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							]
						},
						"description": "Registers a second user (Bob) to test transfers.\n\n**This request automatically saves the new user's ID to the `{{bobUserId}}` collection variable.**"
					},
					"response": []
				},
				{
					"name": "[GET] Get All Users (Paginated)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users?page=1&limit=5",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "limit",
									"value": "5"
								}
							]
						},
						"description": "Retrieves a paginated list of all users. You can adjust the `page` and `limit` query parameters."
					},
					"response": []
				},
				{
					"name": "[GET] Get User by ID (Alice)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users/{{aliceUserId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{aliceUserId}}"
							]
						},
						"description": "Retrieves a single user's details by their CUID. \n\nThis request uses the `{{aliceUserId}}` variable, which is automatically set when you run the `[POST] Create User (Alice)` request."
					},
					"response": []
				}
			]
		},
		{
			"name": "Transactions",
			"description": "Endpoints for simulating funds transfers and viewing transaction history.",
			"item": [
				{
					"name": "[POST] Create Transfer (Alice to Bob)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"senderId\": \"{{aliceUserId}}\",\n  \"receiverEmail\": \"bob@flowserve.com\",\n  \"amount\": 50.25\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/transactions/transfer",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transactions",
								"transfer"
							]
						},
						"description": "Simulates a funds transfer from one user to another. \n\nThis request uses the `{{aliceUserId}}` variable set from creating Alice. It sends money to Bob's email (`bob@flowserve.com`). \n\nThis transaction is **atomic** on the backend, meaning it will either fully complete (debit Alice, credit Bob, create log) or fail entirely, ensuring no funds are lost."
					},
					"response": []
				},
				{
					"name": "[POST] Create Transfer (Insufficient Funds)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"senderId\": \"{{aliceUserId}}\",\n  \"receiverEmail\": \"bob@flowserve.com\",\n  \"amount\": 9999999\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/transactions/transfer",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transactions",
								"transfer"
							]
						},
						"description": "Tests the error case for an insufficient funds transfer. This should return a **400 Bad Request** error with the message \"Insufficient funds\"."
					},
					"response": []
				},
				{
					"name": "[POST] Create Transfer (Invalid Email)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"senderId\": \"{{aliceUserId}}\",\n  \"receiverEmail\": \"invalid-email\",\n  \"amount\": 10\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/transactions/transfer",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transactions",
								"transfer"
							]
						},
						"description": "Tests the Zod validation for an invalid email. This should return a **400 Bad Request**."
					},
					"response": []
				},
				{
					"name": "[GET] Get Transactions for User (Alice)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transactions/{{aliceUserId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transactions",
								"{{aliceUserId}}"
							]
						},
						"description": "Retrieves a list of all transactions (sent and received) for a specific user.\n\nThis uses the `{{aliceUserId}}` variable."
					},
					"response": []
				},
				{
					"name": "[GET] Get Transactions for User (Bob)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transactions/{{bobUserId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transactions",
								"{{bobUserId}}"
							]
						},
						"description": "Retrieves a list of all transactions (sent and received) for a specific user.This uses the `{{bobUserId}}` variable."
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8000/api/v1",
			"type": "string"
		},
		{
			"key": "aliceUserId",
			"value": "",
			"type": "string"
		},
		{
			"key": "bobUserId",
			"value": "",
			"type": "string"
		}
	]
}

